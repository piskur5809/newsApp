{"ast":null,"code":"var express = require('express');\n\nvar router = express.Router(); // Date\n\nvar reqDate = require('../../requires/date'); //Item Model\n\n\nvar Visitor = require('../../models/Visitor');\n\nrouter.get('/', function (req, res) {\n  Visitor.find({}).then(function (items) {\n    return res.json(items);\n  });\n});\nrouter.post('/', function (req, res) {\n  Visitor.find({}).then(function (items) {\n    var addIp = items[0].visitorsIp; // проверка на наличие IP в базе данных \n\n    if (!addIp.includes(req.ip)) {\n      addIp.push(req.ip);\n    }\n\n    ; // обновляем базу с IP адресами \n\n    Visitor.findOneAndUpdate({\n      date: reqDate.getToday()\n    }, {\n      visitorsIp: addIp\n    }, function (err, item) {\n      if (err) console.log(err);\n    }).then(function (items) {\n      return res.json(items);\n    });\n  });\n});\nmodule.exports = router;","map":null,"metadata":{},"sourceType":"script"}