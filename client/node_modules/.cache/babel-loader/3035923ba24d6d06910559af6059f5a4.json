{"ast":null,"code":"var Visitor = require('../models/Visitor');\n\nvar reqDate = require('./date'); // создает коллецию с IP адресами пользователей на текущий день\n\n\nfunction newVisitors() {\n  Visitor.find({\n    date: reqDate.getToday()\n  }, function (err, doc) {\n    if (!doc.length) {\n      Visitor.create({\n        visitorsIp: [doc.ip],\n        date: reqDate.getToday()\n      });\n    }\n\n    ;\n    if (err) console.log(err);\n  });\n} // удаляет старую коллекцию с IP адресами пользователей предыдущего дня\n\n\nfunction deleteVisitors() {\n  Visitor.deleteMany({\n    date: reqDate.getYesterday()\n  }, function (err, doc) {\n    if (err) console.log(err);\n  });\n}\n\nmodule.exports.newVisitors = newVisitors;\nmodule.exports.deleteVisitors = deleteVisitors;","map":null,"metadata":{},"sourceType":"script"}